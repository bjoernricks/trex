<div class="container-fluid">
    <div class="row">
        <div class="col-md-8">
            <h2 id="project">Project {{project.name}}</h2>

            <div ng-show="project.id">
                <dl class="dl-horizontal">
                    <dt>Description</dt>
                    <dd>
                    {{project.description}}
                    </dd>
                    <dt>Active</dt>
                    <dd>
                    {{project.active|checkmark}}
                    </dd>
                    <dt>Created</dt>
                    <dd>
                    {{project.created|date}}
                    </dd>
                    <dt>Duration</dt>
                    <dd>
                    {{entries|sumByKey:'duration'|workduration}}
                    </dd>
                </dl>
            </div>

            <div ng-show="!project.name && !project_loading">
                Unkown project
            </div>

            <h3 id="entries">Entries</h3>

            <form class="form-horizontal" role="form">
                <div class="form-group">
                    <label for="from_date" class="col-sm-1 control-label">
                        From date:
                    </label>
                    <div class="col-sm-3">
                        <input ng-model="entries_from_date" type="search"
                        class="form-control" id="from_date"
                        ng-enter="searchEntries()"
                        placeholder="date">
                    </div>
                    <label for="to_date" class="col-sm-1 control-label">
                        To date:
                    </label>
                    <div class="col-sm-3">
                        <input ng-model="entries_to_date" type="search"
                        class="form-control" id="to_date"
                        ng-enter="searchEntries()"
                        placeholder="date">
                    </div>
                </div>
                <div class="form-group">
                    <label for="searchstate" class="col-sm-1 control-label">
                        State:
                    </label>
                    <div class="col-sm-3">
                        <input ng-model="entries_state" type="search"
                            class="form-control" id="searchstate"
                            ng-enter="searchEntries()"
                            placeholder="state">
                    </div>
                </div>
                <div class="form-group">
                    <label for="searchuserabbr" class="col-sm-1 control-label">
                        Users:
                    </label>
                    <div class="col-sm-7">
                        <tags-input ng-model="entries_user_abbr"
                            display-property="user_abbr"
                            placeholder="Add a user"
                            add-from-autocomplete-only="true"
                            min-length="1"
                            on-tag-added="searchEntries()"
                            on-tag-removed="searchEntries()">
                            <auto-complete source="completeUser($query)"
                                min-length="1"></auto-complete>
                        </tags-input>
                    </div>
                </div>
                <div class="form-group">
                    <label for="searchtags" class="col-sm-1 control-label">
                        Tags:
                    </label>
                    <div class="col-sm-7">
                        <tags-input ng-model="entries_tags" display-property="name"
                            add-from-autocomplete-only="true"
                            min-length="1"
                            on-tag-added="searchEntries()"
                            on-tag-removed="searchEntries()">
                            <auto-complete source="completeTag($query)"
                                min-length="1"></auto-complete>
                        </tags-input>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-2 col-md-offset-1">
                        <button ng-click="searchEntries()"
                            type="button" class="btn btn-default btn-block">
                            Filter
                        </button>
                    </div>
                </div>
            </form>

            <div ng-show="!entries.length && !entries_loading">
                No entries evailable.
            </div>

            <div ng-show="entries.length">
                <form class="form-horizontal" role="form"
                    style="margin-top: 3em;">
                    <div class="form-group">
                        <label for="searchinput" class="col-sm-1 control-label">
                            Instant Search:
                        </label>
                        <div class="col-sm-3">
                            <input ng-model="query" type="search"
                                class="form-control" id="searchinput"
                                placeholder="search">
                        </div>
                    </div>
                </form>

                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>
                                <a ng-click="setOrder('id')">
                                    ID
                                </a>
                            </th>
                            <th>
                                <a ng-click="setOrder('date')">
                                    Date
                                </a>
                            </th>
                            <th>
                                <a ng-click="setOrder('duration')">
                                    Duration
                                </a>
                            </th>
                            <th>
                                <a ng-click="setOrder('state')">
                                    State
                                </a>
                            </th>
                            <th>
                                <a ng-click="setOrder('user_abbr')">
                                    User
                                </a>
                            </th>
                            <th>
                                <a ng-click="setOrder('description')">
                                    Description
                                </a>
                            </th>
                            <th>
                                <a ng-click="setOrder('tags')">
                                    Tags
                                </a>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="entry in entries | filter:query | orderBy:order:orderreverse">
                            <td>
                                <a href="#/entries/{{entry.id}}">
                                    {{entry.id}}
                                </a>
                            </td>
                            <td>
                                {{entry.date | date}}
                            <td class="text-right">
                                {{entry.duration | duration}}
                            </td>
                            <td>
                                {{entry.state}}
                            </td>
                            <td>
                                <span ng-click="addUser(entry.user)">
                                    {{entry.user.user_abbr}}
                                </span>
                            </td>
                            <td>
                                {{entry.description}}
                            </td>
                            <td>
                                <span class="label label-default"
                                    ng-repeat="tag in entry.tags"
                                    ng-click="addSearchTag(tag.name)">
                                        {{tag.name}}
                                </span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

